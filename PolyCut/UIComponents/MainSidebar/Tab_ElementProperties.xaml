<UserControl
    x:Class="Tab_ElementProperties"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:c="clr-namespace:ValueConverters;assembly=ValueConverters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:local="clr-namespace:PolyCut"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:pc="clr-namespace:PolyCut.Core;assembly=PolyCut.Core"
    xmlns:polycutShared="clr-namespace:PolyCut.Shared;assembly=PolyCut.Shared"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    d:DataContext="{d:DesignInstance Type=local:SVGPageViewModel}"
    d:DesignHeight="800"
    d:DesignWidth="380"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <Separator Grid.Row="0" Margin="5" />
        <ScrollViewer
            Grid.Row="1"
            Margin="-14,00,-14,0"
            Padding="25,0,25,0"
            CanContentScroll="True"
            IsEnabled="{Binding MainVM.SelectedDrawable, Converter={StaticResource NullToBoolConverter}}"
            VerticalScrollBarVisibility="Visible">
            <DockPanel>

                <StackPanel Margin="0,-10,0,0" DockPanel.Dock="Bottom">

                    <ui:CardExpander
                        Margin="-15,-10"
                        VerticalAlignment="Top"
                        Background="Transparent"
                        BorderBrush="Transparent"
                        ContentPadding="0"
                        FlowDirection="RightToLeft"
                        IsExpanded="True"
                        Style="{StaticResource CustomCardExpanderStyle}">
                        <ui:CardExpander.Header>
                            <Grid Margin="10,0" FlowDirection="LeftToRight">
                                <TextBlock
                                    Padding="1,2,0,0"
                                    VerticalAlignment="Center"
                                    Text="Transform" />
                            </Grid>
                        </ui:CardExpander.Header>

                        <StackPanel Margin="0,0,0,5" FlowDirection="LeftToRight">

                            <Grid Margin="15,0,15,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="25" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="60" />
                                    <ColumnDefinition Width="25" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition Height="8" />
                                    <RowDefinition />
                                    <RowDefinition Height="8" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>

                                <Label
                                    Grid.Row="0"
                                    Padding="1,2,0,0"
                                    VerticalAlignment="Center"
                                    Content="W" />
                                <ui:TextBox
                                    x:Name="WidthTextBox"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    ClearButtonEnabled="False"
                                    GotKeyboardFocus="TextBox_GotKeyboardFocus"
                                    IsEnabled="{Binding MainVM.SelectedDrawables.Count, Converter={StaticResource CountEqualsOneToBoolConverter}}"
                                    LostFocus="TextBox_LostFocus">
                                    <ui:TextBox.Text>
                                        <Binding
                                            Converter="{StaticResource UnitConverter}"
                                            Mode="TwoWay"
                                            Path="MainVM.SelectedWrapper.Width"
                                            UpdateSourceTrigger="Explicit" />

                                    </ui:TextBox.Text>
                                </ui:TextBox>
                                <Label
                                    Grid.Row="0"
                                    Grid.Column="3"
                                    Padding="1,2,0,0"
                                    VerticalAlignment="Center"
                                    Content="H" />
                                <ui:TextBox
                                    x:Name="HeightTextBox"
                                    Grid.Row="0"
                                    Grid.Column="4"
                                    ClearButtonEnabled="False"
                                    GotKeyboardFocus="TextBox_GotKeyboardFocus"
                                    IsEnabled="{Binding MainVM.SelectedDrawables.Count, Converter={StaticResource CountEqualsOneToBoolConverter}}" 
                                    LostFocus="TextBox_LostFocus">
                                    <ui:TextBox.Text>
                                        <Binding
                                            Converter="{StaticResource UnitConverter}"
                                            Mode="TwoWay"
                                            NotifyOnValidationError="True"
                                            Path="MainVM.SelectedWrapper.Height"
                                            UpdateSourceTrigger="Explicit"
                                            ValidatesOnExceptions="True" />

                                    </ui:TextBox.Text>
                                </ui:TextBox>

                                <Label
                                    Grid.Row="2"
                                    Padding="1,2,0,0"
                                    VerticalAlignment="Center"
                                    Content="X" />
                                <ui:TextBox
                                    x:Name="XTextBox"
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    ClearButtonEnabled="False"
                                    GotKeyboardFocus="TextBox_GotKeyboardFocus"
                                    IsEnabled="{Binding MainVM.SelectedDrawables.Count, Converter={StaticResource CountEqualsOneToBoolConverter}}"
                                    LostFocus="TextBox_LostFocus"
                                    Text="{Binding MainVM.SelectedWrapper.(Canvas.Left), Mode=TwoWay, Converter={StaticResource UnitConverter}, UpdateSourceTrigger=Explicit}" />
                                <Label
                                    Grid.Row="2"
                                    Grid.Column="3"
                                    Padding="1,2,0,0"
                                    VerticalAlignment="Center"
                                    Content="Y" />
                                <ui:TextBox
                                    x:Name="YTextBox"
                                    Grid.Row="2"
                                    Grid.Column="4"
                                    ClearButtonEnabled="False"
                                    GotKeyboardFocus="TextBox_GotKeyboardFocus"
                                    IsEnabled="{Binding MainVM.SelectedDrawables.Count, Converter={StaticResource CountEqualsOneToBoolConverter}}"
                                    LostFocus="TextBox_LostFocus"
                                    Text="{Binding MainVM.SelectedWrapper.(Canvas.Top), Mode=TwoWay, Converter={StaticResource UnitConverter}, UpdateSourceTrigger=Explicit}" />

                                <Label
                                    Grid.Row="4"
                                    Padding="1,2,0,0"
                                    VerticalAlignment="Center"
                                    Content="R" />
                                <ui:NumberBox
                                    Grid.Row="4"
                                    Grid.Column="1"
                                    AcceptsReturn="False"
                                    ClearButtonEnabled="False"
                                    GotKeyboardFocus="TextBox_GotKeyboardFocus"
                                    LostKeyboardFocus="NumberBox_LostFocus"
                                    Maximum="360"
                                    Minimum="-360"
                                    SpinButtonPlacementMode="Compact"
                                    Value="{Binding MainVM.SelectedWrapper.RenderTransform.(RotateTransform.Angle), Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <ui:Button
                                    Grid.Row="4"
                                    Grid.Column="4"
                                    Width="50"
                                    Command="{Binding MirrorHorizontallyCommand}">
                                    <ui:SymbolIcon Filled="False" Symbol="FlipHorizontal16" />
                                </ui:Button>
                                <ui:Button
                                    Grid.Row="4"
                                    Grid.Column="4"
                                    Width="50"
                                    HorizontalAlignment="Right"
                                    Command="{Binding MirrorVerticallyCommand}">
                                    <ui:SymbolIcon Filled="False" Symbol="FlipVertical16" />
                                </ui:Button>

                                <Label
                                    Grid.Column="1"
                                    Padding="1,2,10,0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    Content="mm"
                                    Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                <Label
                                    Grid.Column="4"
                                    Padding="1,2,10,0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    Content="mm"
                                    Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                <Label
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Padding="1,2,10,0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    Content="mm"
                                    Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                <Label
                                    Grid.Row="2"
                                    Grid.Column="4"
                                    Padding="1,2,10,0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    Content="mm"
                                    Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                <Label
                                    Grid.Row="4"
                                    Grid.Column="1"
                                    Padding="1,2,25,0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    Content="°"
                                    Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                            </Grid>

                            <Separator Margin="0,5" />
                        </StackPanel>

                    </ui:CardExpander>




                    <ui:CardExpander
                        Margin="-15,-10"
                        VerticalAlignment="Top"
                        Background="Transparent"
                        BorderBrush="Transparent"
                        ContentPadding="0"
                        FlowDirection="RightToLeft"
                        IsExpanded="True"
                        Style="{StaticResource CustomCardExpanderStyle}">
                        <ui:CardExpander.Header>
                            <Grid Margin="10,0" FlowDirection="LeftToRight">
                                <TextBlock
                                    Padding="1,2,0,0"
                                    VerticalAlignment="Center"
                                    Text="Style" />
                            </Grid>
                        </ui:CardExpander.Header>

                        <StackPanel Margin="15,-5,15,0" FlowDirection="LeftToRight">


                            <local:ColorPickerControl
                                Margin="0,6,0,0"
                                ColorSelected="FillColorPicker_ColorSelected"
                                CurrentColor="{Binding MainVM.SelectedDrawable.Fill, Mode=OneWay}"
                                LabelText="Fill"
                                PopupOpening="FillColorPicker_PopupOpening" />

                            <local:ColorPickerControl
                                Margin="0,6,0,0"
                                ColorSelected="StrokeColorPicker_ColorSelected"
                                CurrentColor="{Binding MainVM.SelectedDrawable.Stroke, Mode=OneWay}"
                                LabelText="Stroke"
                                PopupOpening="StrokeColorPicker_PopupOpening" />

                            <Grid Margin="0,6,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Orientation="Horizontal">
                                    <Label VerticalAlignment="Center" Content="Stroke Thickness" />
                                    <ui:SymbolIcon
                                        Margin="2,-3,0,0"
                                        Foreground="{StaticResource PaletteAmberBrush}"
                                        Symbol="Important20" />
                                    <StackPanel.ToolTip>
                                        <ToolTip MaxWidth="544">
                                            <TextBlock
                                                Width="350"
                                                Text="Increasing the thickness will not affect the actual Gcode stroke width. However, setting it to zero will disable the stroke."
                                                TextAlignment="Left"
                                                TextWrapping="Wrap" />
                                        </ToolTip>

                                    </StackPanel.ToolTip>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Slider
                                        x:Name="ThicknessSlider"
                                        Width="120"
                                        Margin="0,0,8,0"
                                        VerticalAlignment="Center"
                                        IsSnapToTickEnabled="True"
                                        Maximum="10"
                                        Minimum="0"
                                        TickFrequency="1"
                                        TickPlacement="BottomRight"
                                        ValueChanged="ThicknessSlider_ValueChanged" />
                                    <TextBlock
                                        Width="25"
                                        VerticalAlignment="Center"
                                        Text="{Binding ElementName=ThicknessSlider, Path=Tag, FallbackValue=0}"
                                        TextAlignment="Right" />
                                </StackPanel>
                            </Grid>

                            <Separator Margin="0,5" />
                        </StackPanel>
                    </ui:CardExpander>


                    <ui:CardExpander
                        Margin="-15,-10"
                        VerticalAlignment="Top"
                        Background="Transparent"
                        BorderBrush="Transparent"
                        ContentPadding="0"
                        FlowDirection="RightToLeft"
                        IsExpanded="True"
                        Style="{StaticResource CustomCardExpanderStyle}">
                        <ui:CardExpander.Header>
                            <Grid Margin="10,0" FlowDirection="LeftToRight">

                                <TextBlock
                                    Padding="1,2,0,0"
                                    VerticalAlignment="Center"
                                    Text="Combine Shapes" />

                            </Grid>
                        </ui:CardExpander.Header>

                        <StackPanel FlowDirection="LeftToRight">

                            <Grid Margin="35,0,15,0">


                                <StackPanel Orientation="Horizontal">
                                    <ui:Button
                                        Width="60"
                                        Margin="5,0,5,0"
                                        Command="{Binding MainVM.UnionShapesCommand}">
                                        <ui:Button.ToolTip>
                                            <TextBlock Text="Union" />
                                        </ui:Button.ToolTip>
                                        <ui:SymbolIcon
                                            Filled="True"
                                            FontSize="18"
                                            Symbol="ShapeUnion20" />
                                    </ui:Button>
                                    <ui:Button
                                        Width="60"
                                        Margin="5,0,5,0"
                                        Command="{Binding MainVM.IntersectShapesCommand}">
                                        <ui:Button.ToolTip>
                                            <TextBlock Text="Intersect" />
                                        </ui:Button.ToolTip>
                                        <ui:SymbolIcon
                                            Filled="True"
                                            FontSize="18"
                                            Symbol="ShapeIntersect20" />
                                    </ui:Button>
                                    <ui:Button
                                        Width="60"
                                        Margin="5,0,5,0"
                                        Command="{Binding MainVM.SubtractShapesCommand}">
                                        <ui:Button.ToolTip>
                                            <TextBlock Text="Subtract" />
                                        </ui:Button.ToolTip>
                                        <ui:SymbolIcon
                                            Filled="True"
                                            FontSize="18"
                                            Symbol="ShapeSubtract20" />
                                    </ui:Button>
                                    <ui:Button
                                        Width="60"
                                        Margin="5,0,5,0"
                                        Command="{Binding MainVM.XorShapesCommand}">
                                        <ui:Button.ToolTip>
                                            <TextBlock Text="Exclude" />
                                        </ui:Button.ToolTip>
                                        <ui:SymbolIcon
                                            Filled="True"
                                            FontSize="18"
                                            Symbol="ShapeExclude20" />
                                    </ui:Button>

                                </StackPanel>

                            </Grid>
                            <Separator Margin="0,5" />

                        </StackPanel>
                    </ui:CardExpander>
                    <ui:CardExpander
                        Margin="-15,-10"
                        VerticalAlignment="Top"
                        Background="Transparent"
                        BorderBrush="Transparent"
                        ContentPadding="0"
                        FlowDirection="RightToLeft"
                        IsExpanded="True"
                        Style="{StaticResource CustomCardExpanderStyle}"
                        Visibility="{Binding MainVM.SelectedDrawable.DrawableElement, Converter={StaticResource SelectedObjectIsTextboxToVisConverter}, FallbackValue=Collapsed}">
                        <ui:CardExpander.Header>
                            <Grid Margin="10,0" FlowDirection="LeftToRight">

                                <TextBlock
                                    Padding="1,2,0,0"
                                    VerticalAlignment="Center"
                                    Text="Text" />

                            </Grid>
                        </ui:CardExpander.Header>

                        <StackPanel FlowDirection="LeftToRight">

                            <Grid Margin="15,0,15,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="20" />
                                    <ColumnDefinition Width="80" />
                                </Grid.ColumnDefinitions>

                                <local:FontPickerComboBox
                                    Grid.Column="0"
                                    Width="180"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Background="Transparent"
                                    SelectedFont="{Binding MainVM.SelectedDrawable.DrawableElement.(TextBox.FontFamily), Mode=TwoWay}" />

                                <ui:SymbolIcon
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    HorizontalAlignment="Right"
                                    FontSize="16"
                                    Symbol="TextFontSize24" />
                                <ComboBox
                                    Grid.Row="0"
                                    Grid.Column="3"
                                    Width="80"
                                    Padding="7"
                                    HorizontalAlignment="Right"
                                    Background="Transparent"
                                    IsEditable="True"
                                    SelectedIndex="6"
                                    Text="{Binding MainVM.SelectedDrawable.DrawableElement.(TextBox.FontSize), Mode=TwoWay}">
                                    <ComboBoxItem Content="3" />
                                    <ComboBoxItem Content="4" />
                                    <ComboBoxItem Content="6" />
                                    <ComboBoxItem Content="8" />
                                    <ComboBoxItem Content="10" />
                                    <ComboBoxItem Content="12" />
                                    <ComboBoxItem Content="14" />
                                    <ComboBoxItem Content="16" />
                                    <ComboBoxItem Content="18" />
                                    <ComboBoxItem Content="20" />
                                    <ComboBoxItem Content="24" />
                                    <ComboBoxItem Content="28" />
                                    <ComboBoxItem Content="32" />
                                    <ComboBoxItem Content="36" />
                                    <ComboBoxItem Content="48" />
                                    <ComboBoxItem Content="72" />
                                </ComboBox>




                            </Grid>
                        </StackPanel>
                    </ui:CardExpander>

                </StackPanel>

            </DockPanel>
        </ScrollViewer>

    </Grid>
</UserControl>
