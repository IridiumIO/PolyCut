<UserControl x:Class="MainSidebar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:c="clr-namespace:ValueConverters;assembly=ValueConverters"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors" xmlns:local="clr-namespace:PolyCut"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:pc="clr-namespace:PolyCut.Core;assembly=PolyCut.Core"
             xmlns:polycutShared="clr-namespace:PolyCut.Shared;assembly=PolyCut.Shared"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             x:Name="MainSidebar"
             d:DataContext="{d:DesignInstance Type=local:SVGPageViewModel}"
             d:DesignHeight="800" d:DesignWidth="380" x:FieldModifier="public"
             mc:Ignorable="d">
    <Grid VerticalAlignment="Stretch">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <!--<RowDefinition  Height="50"/>-->
        </Grid.RowDefinitions>
        <TabControl Margin="0" VerticalAlignment="Stretch"
                    BorderBrush="Transparent">
            <TabItem IsSelected="True" Style="{StaticResource CustomTabStyle}">
                <TabItem.Header>
                    <StackPanel Margin="5,0,5,0" Orientation="Horizontal">
                        <ui:SymbolIcon Symbol="PuzzlePiece24" />
                        <TextBlock Text="Elements"
                                   Margin="6,0,0,0"
                                   Visibility="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=TabItem}, Converter={StaticResource BoolToVisibilityConverter}}" />

                    </StackPanel>
                </TabItem.Header>
                <local:Tab_Elements />
            </TabItem>

            <TabItem Style="{StaticResource CustomTabStyle}">
                <TabItem.Header>
                    <StackPanel Margin="5,0,5,0" Orientation="Horizontal">
                        <ui:SymbolIcon Margin="0,0,6,0" Symbol="AlignLeft16" />
                        <TextBlock Text="Properties" Visibility="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=TabItem}, Converter={StaticResource BoolToVisibilityConverter}}" />

                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Separator Grid.Row="0" Margin="5" />
                    <ScrollViewer Grid.Row="1"
                                  Margin="-14,00,-14,0" Padding="25,0,25,0"
                                  CanContentScroll="True"
                                  IsEnabled="{Binding MainVM.SelectedDrawable, Converter={StaticResource NullToBoolConverter}}"
                                  VerticalScrollBarVisibility="Visible">
                        <DockPanel>

                            <StackPanel DockPanel.Dock="Bottom">

                                <ui:CardExpander Margin="-15,0" VerticalAlignment="Top"
                                                 Background="Transparent" BorderBrush="Transparent" ContentPadding="0"
                                                 FlowDirection="RightToLeft" IsExpanded="True"
                                                 Style="{StaticResource CustomCardExpanderStyle}">
                                    <ui:CardExpander.Header>
                                        <Grid Margin="10,0" FlowDirection="LeftToRight">

                                            <TextBlock Text="Transform"
                                                       Padding="1,2,0,0" VerticalAlignment="Center" />

                                        </Grid>
                                    </ui:CardExpander.Header>

                                    <StackPanel FlowDirection="LeftToRight">

                                        <Grid Margin="15,0,15,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="25" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="60" />
                                                <ColumnDefinition Width="25" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition Height="8" />
                                                <RowDefinition />
                                                <RowDefinition Height="8" />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>

                                            <Label Content="W"
                                                   Grid.Row="0"
                                                   Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <ui:TextBox Text="{Binding MainVM.SelectedDrawable.DrawableElement.Parent.Width, Mode=TwoWay, Converter={StaticResource UnitConverter}}"
                                                        Grid.Row="0" Grid.Column="1"
                                                        ClearButtonEnabled="False" />
                                            <Label Content="H"
                                                   Grid.Row="0" Grid.Column="3"
                                                   Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <ui:TextBox Text="{Binding MainVM.SelectedDrawable.DrawableElement.Parent.Height, Mode=TwoWay, Converter={StaticResource UnitConverter}}"
                                                        Grid.Row="0" Grid.Column="4"
                                                        ClearButtonEnabled="False" />

                                            <Label Content="X"
                                                   Grid.Row="2"
                                                   Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <ui:TextBox Text="{Binding MainVM.SelectedDrawable.DrawableElement.Parent.(Canvas.Left), Mode=TwoWay, Converter={StaticResource UnitConverter}}"
                                                        Grid.Row="2" Grid.Column="1"
                                                        ClearButtonEnabled="False" />
                                            <Label Content="Y"
                                                   Grid.Row="2" Grid.Column="3"
                                                   Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <ui:TextBox Text="{Binding MainVM.SelectedDrawable.DrawableElement.Parent.(Canvas.Top), Mode=TwoWay, Converter={StaticResource UnitConverter}}"
                                                        Grid.Row="2" Grid.Column="4"
                                                        ClearButtonEnabled="False" />

                                            <Label Content="R"
                                                   Grid.Row="4"
                                                   Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <ui:NumberBox Grid.Row="4" Grid.Column="1"
                                                          AcceptsReturn="False" ClearButtonEnabled="False" LostFocus="NumberBox_LostFocus"
                                                          Maximum="360" Minimum="-360" SpinButtonPlacementMode="Compact"
                                                          Value="{Binding MainVM.SelectedDrawable.DrawableElement.Parent.RenderTransform.(RotateTransform.Angle), Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                            <ui:Button Grid.Row="4" Grid.Column="4"
                                                       Width="50"
                                                       Command="{Binding MirrorHorizontallyCommand}">
                                                <ui:SymbolIcon Filled="False" Symbol="FlipHorizontal16" />
                                            </ui:Button>
                                            <ui:Button Grid.Row="4" Grid.Column="4"
                                                       Width="50"
                                                       HorizontalAlignment="Right"
                                                       Command="{Binding MirrorVerticallyCommand}">
                                                <ui:SymbolIcon Filled="False" Symbol="FlipVertical16" />
                                            </ui:Button>

                                            <Label Content="mm"
                                                   Grid.Column="1"
                                                   Padding="1,2,10,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                            <Label Content="mm"
                                                   Grid.Column="4"
                                                   Padding="1,2,10,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                            <Label Content="mm"
                                                   Grid.Row="2" Grid.Column="1"
                                                   Padding="1,2,10,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                            <Label Content="mm"
                                                   Grid.Row="2" Grid.Column="4"
                                                   Padding="1,2,10,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                            <Label Content="°"
                                                   Grid.Row="4" Grid.Column="1"
                                                   Padding="1,2,25,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                        </Grid>
                                    </StackPanel>

                                </ui:CardExpander>
                                <Separator Margin="5" />

                                <ui:CardExpander Margin="-15,0" VerticalAlignment="Top"
                                                 Background="Transparent" BorderBrush="Transparent" ContentPadding="0"
                                                 FlowDirection="RightToLeft" IsExpanded="True"
                                                 Style="{StaticResource CustomCardExpanderStyle}"
                                                 Visibility="{Binding MainVM.SelectedDrawable.DrawableElement, Converter={StaticResource SelectedObjectIsTextboxToVisConverter}, FallbackValue=Hidden}">
                                    <ui:CardExpander.Header>
                                        <Grid Margin="10,0" FlowDirection="LeftToRight">

                                            <TextBlock Text="Text"
                                                       Padding="1,2,0,0" VerticalAlignment="Center" />

                                        </Grid>
                                    </ui:CardExpander.Header>

                                    <StackPanel FlowDirection="LeftToRight">

                                        <Grid Margin="15,0,15,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="20" />
                                                <ColumnDefinition Width="80" />
                                            </Grid.ColumnDefinitions>

                                            <local:FontPickerComboBox Grid.Column="0"
                                                                      Width="180"
                                                                      HorizontalAlignment="Left" VerticalAlignment="Center"
                                                                      Background="Transparent"
                                                                      SelectedFont="{Binding MainVM.SelectedDrawable.DrawableElement.(TextBox.FontFamily), Mode=TwoWay}" />

                                            <ui:SymbolIcon Grid.Row="0" Grid.Column="1"
                                                           HorizontalAlignment="Right"
                                                           FontSize="16" Symbol="TextFontSize24" />
                                            <ComboBox Text="{Binding MainVM.SelectedDrawable.DrawableElement.(TextBox.FontSize), Mode=TwoWay}"
                                                      Grid.Row="0" Grid.Column="3"
                                                      Width="80"
                                                      Padding="7" HorizontalAlignment="Right"
                                                      Background="Transparent" IsEditable="True" SelectedIndex="6">
                                                <ComboBoxItem Content="3" />
                                                <ComboBoxItem Content="4" />
                                                <ComboBoxItem Content="6" />
                                                <ComboBoxItem Content="8" />
                                                <ComboBoxItem Content="10" />
                                                <ComboBoxItem Content="12" />
                                                <ComboBoxItem Content="14" />
                                                <ComboBoxItem Content="16" />
                                                <ComboBoxItem Content="18" />
                                                <ComboBoxItem Content="20" />
                                                <ComboBoxItem Content="24" />
                                                <ComboBoxItem Content="28" />
                                                <ComboBoxItem Content="32" />
                                                <ComboBoxItem Content="36" />
                                                <ComboBoxItem Content="48" />
                                                <ComboBoxItem Content="72" />
                                            </ComboBox>




                                        </Grid>
                                    </StackPanel>
                                </ui:CardExpander>

                            </StackPanel>

                        </DockPanel>
                    </ScrollViewer>

                </Grid>
            </TabItem>

            <TabItem Width="9"
                     Margin="0,0,-6,0"
                     IsEnabled="False" IsHitTestVisible="False"
                     Style="{StaticResource CustomTabStyle}">
                <TabItem.Header>
                    <Separator Height="28" Background="{StaticResource CardBackground}" />
                </TabItem.Header>
            </TabItem>


            <TabItem Style="{StaticResource CustomTabStyle}">
                <TabItem.Header>
                    <StackPanel Margin="5,0" Orientation="Horizontal">
                        <ui:SymbolIcon Margin="0,0,6,0" Symbol="LayerDiagonal20" />
                        <TextBlock Text="Align" />

                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Separator Grid.Row="0" Margin="5" />
                    <ScrollViewer Grid.Row="1"
                                  Margin="-14,10,-14,0" Padding="25,0,25,0"
                                  CanContentScroll="True" VerticalScrollBarVisibility="Visible">
                        <DockPanel>

                            <StackPanel DockPanel.Dock="Bottom">

                                <Label Content="Input SVG"
                                       Grid.Row="0"
                                       Visibility="Collapsed" />

                                <!--<Grid Margin="0,5,0,15" Visibility="Collapsed">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="*" />
                      <ColumnDefinition Width="5" />
                      <ColumnDefinition Width="auto" />
                    </Grid.ColumnDefinitions>
                    <ui:TextBox Text="{Binding SVGSource}" />
                    <ui:Button Content="Browse..."
                               Grid.Column="2"
                               Command="{Binding BrowseSVGCommand}" />
                  </Grid>

                                        <CheckBox Content="Ignore Hidden" Visibility="Collapsed"
                            IsChecked="{Binding Configuration.IgnoreHidden, Mode=TwoWay}" />
                  <CheckBox Content="Ignore Locked" Visibility="Collapsed"
                            IsChecked="{Binding Configuration.IgnoreLocked, Mode=TwoWay}" />-->

                                <Separator Margin="0,10" Visibility="Collapsed" />

                                <ui:CardExpander Margin="-15,0"
                                                 Background="Transparent" BorderBrush="Transparent" ContentPadding="0"
                                                 FlowDirection="RightToLeft" IsExpanded="True"
                                                 Style="{StaticResource CustomCardExpanderStyle}">
                                    <ui:CardExpander.Header>
                                        <Grid Margin="10,0" FlowDirection="LeftToRight">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="240" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="Printer"
                                                       Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <Grid Grid.Column="2" Margin="10,0,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="auto" />
                                                </Grid.ColumnDefinitions>
                                                <ComboBox Grid.Column="0"
                                                          Background="Transparent" DisplayMemberPath="Name"
                                                          ItemsSource="{Binding MainVM.Printers}"
                                                          SelectedItem="{Binding MainVM.Printer}" />
                                                <ui:Button Grid.Column="1"
                                                           Width="25" Height="35"
                                                           Margin="-55,0,-10,0" Padding="0"
                                                           Background="Transparent" BorderBrush="Transparent"
                                                           Command="{Binding MainVM.SavePrinterCommand}"
                                                           CommandParameter="Ender 3 S1">
                                                    <ui:SymbolIcon Margin="0" Symbol="Save24" />
                                                </ui:Button>
                                            </Grid>

                                        </Grid>
                                    </ui:CardExpander.Header>

                                    <StackPanel Margin="14,0" FlowDirection="LeftToRight">
                                        <StackPanel.Background>
                                            <SolidColorBrush Color="Transparent" />
                                        </StackPanel.Background>

                                        <Label Content="Bed Dimensions" Margin="0,0,0,10" />

                                        <Grid Margin="0,0,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="25" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="60" />
                                                <ColumnDefinition Width="25" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition Height="5" />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <Label Content="W"
                                                   Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <ui:TextBox x:Name="canvasW"
                                                        Text="{Binding MainVM.Printer.BedWidth, Mode=TwoWay, UpdateSourceTrigger=LostFocus, Converter={StaticResource UnitConverter}}"
                                                        Grid.Column="1"
                                                        ClearButtonEnabled="False" />
                                            <Label Content="H"
                                                   Grid.Row="0" Grid.Column="3"
                                                   Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <ui:TextBox x:Name="canvasH"
                                                        Text="{Binding MainVM.Printer.BedHeight, Mode=TwoWay, UpdateSourceTrigger=LostFocus, Converter={StaticResource UnitConverter}}"
                                                        Grid.Row="0" Grid.Column="4"
                                                        ClearButtonEnabled="False" />
                                            <Label Content="mm"
                                                   Grid.Column="1"
                                                   Padding="1,2,10,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                            <Label Content="mm"
                                                   Grid.Column="4"
                                                   Padding="1,2,10,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                        </Grid>

                                        <StackPanel Margin="0,10,0,10" Orientation="Horizontal">

                                            <Label Content="Working Area" Margin="0,4,10,0" />

                                            <ToggleButton x:Name="WorkingAreaVisibilityToggle" IsChecked="True">
                                                <ToggleButton.Template>
                                                    <ControlTemplate>
                                                        <ContentControl>
                                                            <ContentControl.Style>
                                                                <Style TargetType="ContentControl">
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}}}" Value="True">
                                                                            <Setter Property="Content">
                                                                                <Setter.Value>
                                                                                    <ui:Card Padding="8,4"
                                                                                             Background="Transparent"
                                                                                             BorderBrush="{StaticResource PaletteBlueBrush}">
                                                                                        <ui:SymbolIcon Symbol="Eye24" />
                                                                                    </ui:Card>
                                                                                </Setter.Value>
                                                                            </Setter>

                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}}}" Value="False">
                                                                            <Setter Property="Content">
                                                                                <Setter.Value>
                                                                                    <ui:Card Padding="8,4"
                                                                                             Background="Transparent"
                                                                                             BorderBrush="{StaticResource ControlFillColorSecondaryBrush}">
                                                                                        <!--  Replace with your unchecked icon  -->
                                                                                        <ui:SymbolIcon Symbol="EyeOff24" />
                                                                                    </ui:Card>
                                                                                </Setter.Value>
                                                                            </Setter>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </ContentControl.Style>
                                                        </ContentControl>
                                                    </ControlTemplate>
                                                </ToggleButton.Template>
                                            </ToggleButton>

                                        </StackPanel>

                                        <Grid Margin="0,0,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="25" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="60" />
                                                <ColumnDefinition Width="25" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition Height="5" />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>

                                            <Label Content="X"
                                                   Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <ui:TextBox Text="{Binding MainVM.Printer.WorkingOffsetX, Mode=TwoWay, UpdateSourceTrigger=LostFocus, Converter={StaticResource UnitConverter}}"
                                                        Grid.Column="1"
                                                        ClearButtonEnabled="False" />
                                            <Label Content="Y"
                                                   Grid.Row="0" Grid.Column="3"
                                                   Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <ui:TextBox Text="{Binding MainVM.Printer.WorkingOffsetY, Mode=TwoWay, UpdateSourceTrigger=LostFocus, Converter={StaticResource UnitConverter}}"
                                                        Grid.Row="0" Grid.Column="4"
                                                        ClearButtonEnabled="False" />

                                            <Label Content="W"
                                                   Grid.Row="2"
                                                   Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <ui:TextBox Text="{Binding MainVM.Printer.WorkingWidth, Mode=TwoWay, UpdateSourceTrigger=LostFocus, Converter={StaticResource UnitConverter}}"
                                                        Grid.Row="2" Grid.Column="1"
                                                        ClearButtonEnabled="False" />
                                            <Label Content="H"
                                                   Grid.Row="2" Grid.Column="3"
                                                   Padding="1,2,0,0" VerticalAlignment="Center" />
                                            <ui:TextBox Text="{Binding MainVM.Printer.WorkingHeight, Mode=TwoWay, UpdateSourceTrigger=LostFocus, Converter={StaticResource UnitConverter}}"
                                                        Grid.Row="2" Grid.Column="4"
                                                        ClearButtonEnabled="False" />

                                            <Label Content="mm"
                                                   Grid.Column="1"
                                                   Padding="1,2,10,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                            <Label Content="mm"
                                                   Grid.Column="4"
                                                   Padding="1,2,10,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                            <Label Content="mm"
                                                   Grid.Row="2" Grid.Column="1"
                                                   Padding="1,2,10,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                            <Label Content="mm"
                                                   Grid.Row="2" Grid.Column="4"
                                                   Padding="1,2,10,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                        </Grid>

                                    </StackPanel>

                                </ui:CardExpander>

                                <Separator Margin="0,10,0,5" />
                                <ui:CardExpander x:Name="cuttingMat_AlignmentBoxes"
                                                 Margin="-15,0"
                                                 Background="Transparent" BorderBrush="Transparent" ContentPadding="0"
                                                 FlowDirection="RightToLeft" IsExpanded="True"
                                                 Style="{StaticResource CustomCardExpanderStyle}">
                                    <ui:CardExpander.Header>
                                        <Grid Margin="10,0" FlowDirection="LeftToRight">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="220" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="Mat"
                                                       Padding="1,2,10,0" VerticalAlignment="Center" />
                                            <ToggleButton x:Name="CuttingMatVisibilityToggle"
                                                          Grid.Column="1"
                                                          IsChecked="True">
                                                <ToggleButton.Template>
                                                    <ControlTemplate>
                                                        <ContentControl>
                                                            <ContentControl.Style>
                                                                <Style TargetType="ContentControl">
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}}}" Value="True">
                                                                            <Setter Property="Content">
                                                                                <Setter.Value>
                                                                                    <ui:Card Padding="8,4"
                                                                                             Background="Transparent"
                                                                                             BorderBrush="{StaticResource PaletteBlueBrush}">
                                                                                        <ui:SymbolIcon Symbol="Eye24" />
                                                                                    </ui:Card>
                                                                                </Setter.Value>
                                                                            </Setter>

                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}}}" Value="False">
                                                                            <Setter Property="Content">
                                                                                <Setter.Value>
                                                                                    <ui:Card Padding="8,4"
                                                                                             Background="Transparent"
                                                                                             BorderBrush="{StaticResource ControlFillColorSecondaryBrush}">
                                                                                        <!--  Replace with your unchecked icon  -->
                                                                                        <ui:SymbolIcon Symbol="EyeOff24" />
                                                                                    </ui:Card>
                                                                                </Setter.Value>
                                                                            </Setter>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </ContentControl.Style>
                                                        </ContentControl>
                                                    </ControlTemplate>
                                                </ToggleButton.Template>
                                            </ToggleButton>

                                            <Grid Grid.Column="3" Margin="10,0,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="auto" />
                                                </Grid.ColumnDefinitions>
                                                <ComboBox Grid.Column="0"
                                                          Padding="10,8,30,8"
                                                          Background="Transparent" DisplayMemberPath="DisplayName"
                                                          ItemsSource="{Binding MainVM.CuttingMats}"
                                                          SelectedItem="{Binding MainVM.CuttingMat}" />
                                                <ui:Button Grid.Column="1"
                                                           Width="25" Height="35"
                                                           Margin="-55,0,-10,0" Padding="0"
                                                           Background="Transparent" BorderBrush="Transparent"
                                                           Command="{Binding MainVM.SaveCuttingMatCommand}"
                                                           CommandParameter="Cricut StandardGrip 12''">
                                                    <ui:SymbolIcon Margin="0" Symbol="Save24" />
                                                </ui:Button>
                                            </Grid>

                                        </Grid>
                                    </ui:CardExpander.Header>

                                    <StackPanel Margin="14,0" FlowDirection="LeftToRight">

                                        <Label Content="Alignment" Margin="0,0,0,0" />

                                        <Grid Margin="10,10,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="10" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition Height="5" />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <ComboBox ItemsSource="{Binding MainVM.CuttingMat.VerticalAlignment}"
                                                      SelectedIndex="0"
                                                      SelectedItem="{Binding MainVM.CuttingMat.SelectedVerticalAlignment, Mode=TwoWay}" />
                                            <ComboBox Grid.Column="2"
                                                      ItemsSource="{Binding MainVM.CuttingMat.HorizontalAlignment}"
                                                      SelectedIndex="0"
                                                      SelectedItem="{Binding MainVM.CuttingMat.SelectedHorizontalAlignment, Mode=TwoWay}" />
                                        </Grid>

                                        <Grid Margin="0,10,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition Width="15" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition Height="5" />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>

                                            <Label Content="Rotation" VerticalAlignment="Center" />

                                            <ComboBox x:Name="Rotation"
                                                      Grid.Column="2"
                                                      ItemsSource="{Binding MainVM.CuttingMat.Rotation}"
                                                      SelectedIndex="0"
                                                      SelectedItem="{Binding MainVM.CuttingMat.SelectedRotation}">

                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock>
                                                            <Run Text="{Binding Path=.}" />
                                                            <Run Text=" °" />
                                                        </TextBlock>
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>

                                            </ComboBox>
                                        </Grid>

                                    </StackPanel>

                                </ui:CardExpander>

                            </StackPanel>

                        </DockPanel>
                    </ScrollViewer>

                </Grid>
            </TabItem>

            <TabItem Style="{StaticResource CustomTabStyle}">
                <TabItem.Header>
                    <StackPanel Margin="5,0" Orientation="Horizontal">
                        <ui:SymbolIcon Margin="0,0,6,0" Symbol="Options20" />
                        <TextBlock Text="Configure" />

                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Separator Grid.Row="0" Margin="5" />
                    <ScrollViewer Grid.Row="1"
                                  Margin="-14,10,-14,0" Padding="25,0,25,0"
                                  CanContentScroll="True" VerticalScrollBarVisibility="Visible">
                        <DockPanel>

                            <StackPanel DockPanel.Dock="Bottom">
                                <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">

                                    <RadioButton x:Name="modeCut"
                                                 Width="80" Height="60"
                                                 Margin="0,0,20,0"
                                                 IsChecked="{Binding MainVM.Configuration.SelectedToolMode, Mode=TwoWay, Converter={StaticResource RadioButtonConverter}, ConverterParameter={x:Static pc:ProcessorConfiguration+ToolMode.Cut}}"
                                                 Style="{StaticResource {x:Type ToggleButton}}">
                                        <StackPanel>
                                            <ui:SymbolIcon Margin="0,6,0,0" Symbol="CalligraphyPen20" />
                                            <TextBlock Text="Cut"
                                                       Margin="0,4,0,0" HorizontalAlignment="Center"
                                                       FontWeight="SemiBold" />

                                        </StackPanel>

                                        <RadioButton.ToolTip>
                                            <TextBlock TextWrapping="Wrap">
                                                Settings designed for cutting objects out using a drag-knife.
                                            </TextBlock>
                                        </RadioButton.ToolTip>

                                    </RadioButton>
                                    <RadioButton x:Name="modeDraw"
                                                 Width="80" Height="60"
                                                 d:IsChecked="True"
                                                 IsChecked="{Binding MainVM.Configuration.SelectedToolMode, Mode=TwoWay, Converter={StaticResource RadioButtonConverter}, ConverterParameter={x:Static pc:ProcessorConfiguration+ToolMode.Draw}}"
                                                 Style="{StaticResource {x:Type ToggleButton}}">
                                        <StackPanel>
                                            <ui:SymbolIcon Margin="0,6,0,0" Symbol="Pen20" />
                                            <TextBlock Text="Draw"
                                                       Margin="0,4,0,0" HorizontalAlignment="Center"
                                                       FontWeight="SemiBold" />

                                        </StackPanel>
                                        <RadioButton.ToolTip>
                                            <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                Settings designed for drawing using a pen, marker, or even a foil stamping pen.
                                            </TextBlock>
                                        </RadioButton.ToolTip>
                                    </RadioButton>

                                </StackPanel>

                                <Label Content="Travel Speed" Margin="0,20,0,-5" />

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="10" />
                                        <ColumnDefinition Width="100" />
                                    </Grid.ColumnDefinitions>

                                    <Slider x:Name="travelSpeed"
                                            Margin="0,5,0,0" VerticalAlignment="Center"
                                            IsSnapToTickEnabled="True" Maximum="100" Minimum="10" TickFrequency="1"
                                            Value="{Binding MainVM.Configuration.TravelSpeed, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <ui:NumberBox Grid.Column="2"
                                                  Background="Transparent" BorderBrush="Transparent" ClearButtonEnabled="False"
                                                  IsReadOnly="True" SpinButtonPlacementMode="Hidden"
                                                  Value="{Binding MainVM.Configuration.TravelSpeed, Mode=TwoWay, UpdateSourceTrigger=LostFocus}" />
                                    <Label Content="mm/s"
                                           Grid.Column="2"
                                           Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                           VerticalAlignment="Center"
                                           Foreground="{StaticResource ControlFillColorSecondaryBrush}" />
                                    <Grid.ToolTip>
                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                            Speed of the toolhead when the tool is raised and not actively cutting/drawing.
                                        </TextBlock>
                                    </Grid.ToolTip>
                                </Grid>
                                <Label Content="Draw Speed" Margin="0,20,0,-5" />

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="10" />
                                        <ColumnDefinition Width="100" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.ToolTip>
                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                            Speed of the toolhead when the tool is down and cutting/drawing.<LineBreak /><LineBreak />
                                            Slower is usually better</TextBlock>
                                    </Grid.ToolTip>
                                    <Slider x:Name="drawSpeed"
                                            Margin="0,5,0,0" VerticalAlignment="Center"
                                            IsSnapToTickEnabled="True" Maximum="60" Minimum="5" TickFrequency="1"
                                            Value="{Binding MainVM.Configuration.WorkSpeed, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <ui:NumberBox Grid.Column="2"
                                                  Background="Transparent" BorderBrush="Transparent" ClearButtonEnabled="False"
                                                  IsReadOnly="True" SpinButtonPlacementMode="Hidden"
                                                  Value="{Binding MainVM.Configuration.WorkSpeed, Mode=TwoWay, UpdateSourceTrigger=LostFocus}" />
                                    <Label Content="mm/s"
                                           Grid.Column="2"
                                           Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                           VerticalAlignment="Center"
                                           Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                </Grid>
                                <Label Content="Z Height" Margin="0,10,0,10" />
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40" />
                                        <ColumnDefinition Width="10" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="20" />
                                        <ColumnDefinition Width="40" />
                                        <ColumnDefinition Width="10" />
                                        <ColumnDefinition />

                                    </Grid.ColumnDefinitions>
                                    <Grid.ToolTip>
                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                            How high above the workpiece the toolhead should be positioned when travelling or drawing.<LineBreak /><LineBreak />
                                            Positive values are offset above the bed surface.<LineBreak /><LineBreak />
                                            This value is affected by your printer's Z-Offset.</TextBlock>
                                    </Grid.ToolTip>
                                    <Label Content="Draw"
                                           Padding="1,2,0,0" VerticalAlignment="Center" />
                                    <ui:TextBox Text="{Binding MainVM.Configuration.WorkZ}"
                                                Grid.Column="2"
                                                ClearButtonEnabled="False" />
                                    <Label Content="mm"
                                           Grid.Column="2"
                                           Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                           VerticalAlignment="Center"
                                           Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                    <Label Content="Travel"
                                           Grid.Column="4"
                                           Padding="1,2,0,0" VerticalAlignment="Center" />
                                    <ui:TextBox Text="{Binding MainVM.Configuration.TravelZ}"
                                                Grid.Column="6"
                                                ClearButtonEnabled="False" />
                                    <Label Content="mm"
                                           Grid.Column="6"
                                           Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                           VerticalAlignment="Center"
                                           Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                </Grid>

                                <Separator Margin="0,10,0,0" />

                                <StackPanel>

                                    <ui:CardExpander Margin="-15,0"
                                                     Background="Transparent" BorderBrush="Transparent" ContentPadding="0"
                                                     FlowDirection="RightToLeft" IsExpanded="True"
                                                     Style="{StaticResource CustomCardExpanderStyle}">
                                        <ui:CardExpander.Header>
                                            <Label Content="Processing Settings"
                                                   Margin="10,0"
                                                   FlowDirection="LeftToRight" />

                                        </ui:CardExpander.Header>

                                        <StackPanel Margin="15,-10,15,10" FlowDirection="LeftToRight">

                                            <Grid Margin="0,10,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="200" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>

                                                <Label Content="Curve-fitting Precision"
                                                       Margin="0,0,20,0" Padding="1,2,0,0" VerticalAlignment="Center">
                                                    <Label.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            Curved lines are approximated as straight lines when converted to GCode. This sets the effective smallest length that each segment of the curve should be. Smaller values increase accuracy, but massively increase processing time.
                                                        </TextBlock>
                                                    </Label.ToolTip>
                                                </Label>
                                                <ui:TextBox Text="{Binding MainVM.Configuration.Tolerance}"
                                                            Grid.Column="1"
                                                            ClearButtonEnabled="False" />
                                                <Label Content="mm"
                                                       Grid.Column="1"
                                                       Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                                       VerticalAlignment="Center"
                                                       Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                                <CheckBox x:Name="extractSingleColor"
                                                          Content="Extract one colour"
                                                          Grid.Row="2"
                                                          IsChecked="{Binding MainVM.Configuration.ExtractOneColour, Mode=TwoWay}">
                                                    <CheckBox.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            Processes only objects with the specified colour, and ignores all others.
                                                        </TextBlock>
                                                    </CheckBox.ToolTip>
                                                </CheckBox>
                                                <ui:TextBox Text="{Binding MainVM.Configuration.ExtractionColor, Mode=TwoWay}"
                                                            Grid.Row="2" Grid.Column="1"
                                                            Visibility="{Binding ElementName=extractSingleColor, Path=IsChecked, Converter={StaticResource BoolToVisibilityConverter}}" />

                                            </Grid>

                                        </StackPanel>

                                    </ui:CardExpander>

                                    <Separator />

                                    <ui:CardExpander Margin="-15,0"
                                                     Background="Transparent" BorderBrush="Transparent" ContentPadding="0"
                                                     FlowDirection="RightToLeft" IsExpanded="True"
                                                     Style="{StaticResource CustomCardExpanderStyle}"
                                                     Visibility="{Binding ElementName=modeCut, Path=IsChecked, Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <ui:CardExpander.Header>
                                            <Label Content="Blade Settings"
                                                   Margin="10,0"
                                                   FlowDirection="LeftToRight" />

                                        </ui:CardExpander.Header>

                                        <StackPanel Margin="15,-10,15,10" FlowDirection="LeftToRight">
                                            <Grid Margin="0,10,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="200" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>

                                                <Label Content="Tool Diameter"
                                                       Margin="0,0,20,0" Padding="1,2,0,0" VerticalAlignment="Center">
                                                    <Label.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            Diameter of the swivelling part of the cutting blade.<LineBreak />
                                                            Most blades are ~1mm in diameter, however the point of the blade may not be at the very edge.<LineBreak /><LineBreak />
                                                            Setting the tool diameter correctly adds a compensatory swivel for blade rotation to align with the next move. This is most noticeable on tiny features.</TextBlock>
                                                    </Label.ToolTip>
                                                </Label>
                                                <ui:TextBox Text="{Binding MainVM.Configuration.CuttingConfig.ToolDiameter}"
                                                            Grid.Column="1"
                                                            ClearButtonEnabled="False" />
                                                <Label Content="mm"
                                                       Grid.Column="1"
                                                       Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                                       VerticalAlignment="Center"
                                                       Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                                <Label Content="Overcut"
                                                       Grid.Row="2"
                                                       Margin="0,0,20,0" Padding="1,2,0,0" VerticalAlignment="Center">
                                                    <Label.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            Extends cuts by the specified amount to compensate for cutting moves ending slightly too early.<LineBreak /> <LineBreak />
                                                            Recommended value ~1mm</TextBlock>
                                                    </Label.ToolTip>
                                                </Label>
                                                <ui:TextBox Text="{Binding MainVM.Configuration.CuttingConfig.Overcut}"
                                                            Grid.Row="2" Grid.Column="1"
                                                            ClearButtonEnabled="False" />
                                                <Label Content="mm"
                                                       Grid.Row="2" Grid.Column="1"
                                                       Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                                       VerticalAlignment="Center"
                                                       Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                                <Label Content="Cutting order"
                                                       Grid.Row="4"
                                                       Margin="0,0,20,0" Padding="1,2,0,0" VerticalAlignment="Center"
                                                       IsEnabled="{Binding MainVM.UsingGCodePlot}">
                                                    <Label.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            For each object, whether outer features or inner features are cut first.
                                                        </TextBlock>
                                                    </Label.ToolTip>
                                                </Label>

                                                <ComboBox Grid.Row="4" Grid.Column="2"
                                                          IsEnabled="{Binding MainVM.UsingGCodePlot}"
                                                          SelectedIndex="{Binding MainVM.Configuration.InsideOutCuttingOrder}">
                                                    <ComboBoxItem Content="Outer First" />
                                                    <ComboBoxItem Content="Inner First" />

                                                </ComboBox>
                                            </Grid>

                                        </StackPanel>
                                    </ui:CardExpander>

                                    <ui:CardExpander Margin="-15,0"
                                                     Background="Transparent" BorderBrush="Transparent" ContentPadding="0"
                                                     FlowDirection="RightToLeft" IsExpanded="True"
                                                     Style="{StaticResource CustomCardExpanderStyle}"
                                                     Visibility="{Binding ElementName=modeDraw, Path=IsChecked, Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <ui:CardExpander.Header>
                                            <Label Content="Drawing Settings"
                                                   Margin="10,0"
                                                   FlowDirection="LeftToRight" />

                                        </ui:CardExpander.Header>

                                        <StackPanel Margin="15,-10,15,0" FlowDirection="LeftToRight">
                                            <Grid Margin="0,10,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="200" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>

                                                <Label Content="Drawing Angle"
                                                       Grid.Row="0"
                                                       Margin="0,0,20,0" Padding="1,2,0,0" VerticalAlignment="Center"
                                                       IsEnabled="{Binding MainVM.UsingGCodePlot}">
                                                    <Label.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            Specifies the preferred drawing direction for shape outlines.<LineBreak /><LineBreak />
                                                            0° represents East, with positive values rotating counterclockwise.</TextBlock>
                                                    </Label.ToolTip>
                                                </Label>

                                                <ui:TextBox Text="{Binding MainVM.Configuration.DrawingConfig.DrawingDirection, Converter={StaticResource NullableIntConverter}}"
                                                            Grid.Row="0" Grid.Column="1"
                                                            ClearButtonEnabled="True"
                                                            IsEnabled="{Binding MainVM.UsingGCodePlot}" />
                                                <Label Content="°"
                                                       Grid.Row="0" Grid.Column="1"
                                                       Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                                       VerticalAlignment="Center"
                                                       Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                                <!--<Label Content="Optimisation Timeout"
                                                       Grid.Row="2"
                                                       Margin="0,0,20,0" Padding="1,2,0,0" VerticalAlignment="Center"
                                                       IsEnabled="{Binding MainVM.UsingGCodePlot}">
                                                    <Label.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            How long to allow GCodePlot to spend optimising travel paths and drawing directions.
                                                        </TextBlock>
                                                    </Label.ToolTip>
                                                </Label>
                                                <ui:TextBox Text="{Binding MainVM.Configuration.OptimisationTimeout}"
                                                            Grid.Row="2" Grid.Column="1"
                                                            ClearButtonEnabled="False"
                                                            IsEnabled="{Binding MainVM.UsingGCodePlot}" />
                                                <Label Content="sec"
                                                       Grid.Row="2" Grid.Column="1"
                                                       Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                                       VerticalAlignment="Center"
                                                       Foreground="{StaticResource ControlFillColorSecondaryBrush}" />-->


                                                <CheckBox x:Name="optimiseDrawingPaths"
                                                          Content="Optimise Drawing Paths"
                                                          Grid.Row="2"
                                                          IsChecked="{Binding MainVM.Configuration.OptimisedToolPath, Mode=TwoWay}">
                                                    <CheckBox.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            Optimises the order in which lines are drawn to minimise travel time.<LineBreak /><LineBreak />
                                                            Particularly useful for ordering lines when filling shapes.</TextBlock>
                                                    </CheckBox.ToolTip>
                                                </CheckBox>


                                                <CheckBox Content="Allow Travel in Outlines"
                                                          Grid.Row="4"
                                                          IsChecked="{Binding MainVM.Configuration.DrawingConfig.AllowDrawingOverOutlines, Mode=TwoWay}"
                                                          IsEnabled="{Binding MainVM.Configuration.OptimisedToolPath}"
                                                          ToolTipService.ShowOnDisabled="True">
                                                    <CheckBox.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            Allows the pen to travel through shape outlines without lifting the pen up to start the next line.<LineBreak /><LineBreak />
                                                            Requires "Optimise Drawing Paths" to be enabled. Can massively improve overall speed</TextBlock>
                                                    </CheckBox.ToolTip>
                                                </CheckBox>


                                                <CheckBox x:Name="keepOutlines"
                                                          Content="Keep Outlines"
                                                          Grid.Row="6"
                                                          IsChecked="{Binding MainVM.Configuration.DrawingConfig.KeepOutlines, Mode=TwoWay}"
                                                          IsEnabled="{Binding MainVM.UsingGCodePlot, Converter={StaticResource InverseBoolConverter}}">
                                                    <CheckBox.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            Whether shape outlines should be drawn, or ignored.<LineBreak /><LineBreak />
                                                            Disable this if you want to shade in an area without the area being outlined.</TextBlock>
                                                    </CheckBox.ToolTip>
                                                </CheckBox>


                                            </Grid>

                                        </StackPanel>
                                    </ui:CardExpander>
                                    <Separator Visibility="{Binding ElementName=modeDraw, Path=IsChecked, Converter={StaticResource BooleanToVisibilityConverter}}" />

                                    <ui:CardExpander Margin="-15,0"
                                                     Background="Transparent" BorderBrush="Transparent" ContentPadding="0"
                                                     FlowDirection="RightToLeft" IsExpanded="True"
                                                     Style="{StaticResource CustomCardExpanderStyle}"
                                                     Visibility="{Binding ElementName=modeDraw, Path=IsChecked, Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <ui:CardExpander.Header>
                                            <Label Content="Shading Settings"
                                                   Margin="10,0"
                                                   FlowDirection="LeftToRight" />

                                        </ui:CardExpander.Header>

                                        <StackPanel Margin="15,-10,15,10" FlowDirection="LeftToRight">
                                            <Grid Margin="0,10,0,0">
                                                <Grid.Resources>
                                                    <ObjectDataProvider x:Key="dataFromEnum"
                                                                        MethodName="GetValues"
                                                                        ObjectType="{x:Type sys:Enum}">
                                                        <ObjectDataProvider.MethodParameters>
                                                            <x:Type TypeName="pc:FillType" />
                                                        </ObjectDataProvider.MethodParameters>
                                                    </ObjectDataProvider>
                                                </Grid.Resources>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="200" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Label Content="Fill Style"
                                                       Grid.Row="0"
                                                       Margin="0,0,20,0" Padding="1,2,0,0" VerticalAlignment="Center">
                                                    <Label.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            The method used to fill shapes
                                                        </TextBlock>
                                                    </Label.ToolTip>
                                                </Label>

                                                <ComboBox Grid.Row="0" Grid.Column="1"
                                                          SelectedItem="{Binding MainVM.Configuration.DrawingConfig.FillType}" ItemsSource="{Binding Source={StaticResource dataFromEnum}}"/>
                                                
                                              
                                                <Label Content="Shading Threshold"
                                                       Grid.Row="4"
                                                       Margin="0,0,20,0" Padding="1,2,0,0" VerticalAlignment="Center"
                                                       IsEnabled="{Binding MainVM.UsingGCodePlot}">
                                                    <Label.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            Range = 0 to 1<LineBreak /><LineBreak />
                                                            How bright an object should be in order to be shaded. 0 = shade all objects, 1 = shade only fully bright objects.</TextBlock>
                                                    </Label.ToolTip>
                                                </Label>
                                                <ui:NumberBox Grid.Row="4" Grid.Column="1"
                                                              ClearButtonEnabled="False"
                                                              IsEnabled="{Binding MainVM.UsingGCodePlot}"
                                                              LargeChange="0.1" MaxDecimalPlaces="3" Maximum="1.0" Minimum="0.0" SmallChange="0.05"
                                                              Value="{Binding MainVM.Configuration.DrawingConfig.ShadingThreshold}" />

                                                <Label Content="Lightest shading spacing"
                                                       Grid.Row="6"
                                                       Margin="0,0,20,0" Padding="1,2,0,0" VerticalAlignment="Center">
                                                    <Label.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            How far apart drawn lines should be when shading the lightest parts of the image.
                                                        </TextBlock>
                                                    </Label.ToolTip>
                                                </Label>
                                                <ui:TextBox Text="{Binding MainVM.Configuration.DrawingConfig.MaxStrokeWidth}"
                                                            Grid.Row="6" Grid.Column="1"
                                                            ClearButtonEnabled="False"
                                                            IsEnabled="{Binding MainVM.UsingGCodePlot}" />
                                                <Label Content="mm"
                                                       Grid.Row="6" Grid.Column="1"
                                                       Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                                       VerticalAlignment="Center"
                                                       Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                                <Label Content="Darkest shading spacing"
                                                       Grid.Row="8"
                                                       Margin="0,0,20,0" Padding="1,2,0,0" VerticalAlignment="Center">
                                                    <Label.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            How far apart drawn lines should be when shading the darkest parts of the image.
                                                        </TextBlock>
                                                    </Label.ToolTip>
                                                </Label>
                                                <ui:TextBox Text="{Binding MainVM.Configuration.DrawingConfig.MinStrokeWidth}"
                                                            Grid.Row="8" Grid.Column="1"
                                                            ClearButtonEnabled="False" />
                                                <Label Content="mm"
                                                       Grid.Row="8" Grid.Column="1"
                                                       Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                                       VerticalAlignment="Center"
                                                       Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                                <Label Content="Shading angle"
                                                       Grid.Row="10"
                                                       Margin="0,0,20,0" Padding="1,2,0,0" VerticalAlignment="Center">
                                                    <Label.ToolTip>
                                                        <TextBlock TextAlignment="Left" TextWrapping="Wrap">
                                                            Which Direction to draw when shading objects.<LineBreak /><LineBreak />
                                                            0° represents East, with positive values rotating counterclockwise.</TextBlock>
                                                    </Label.ToolTip>
                                                </Label>
                                                <ui:TextBox Text="{Binding MainVM.Configuration.DrawingConfig.ShadingAngle}"
                                                            Grid.Row="10" Grid.Column="1"
                                                            ClearButtonEnabled="False" />
                                                <Label Content="°"
                                                       Grid.Row="10" Grid.Column="1"
                                                       Margin="-50,0,0,0" Padding="1,2,10,0" HorizontalAlignment="Right"
                                                       VerticalAlignment="Center"
                                                       Foreground="{StaticResource ControlFillColorSecondaryBrush}" />

                                            </Grid>
                                        </StackPanel>
                                    </ui:CardExpander>

                                </StackPanel>

                            </StackPanel>

                        </DockPanel>
                    </ScrollViewer>
                </Grid>
            </TabItem>



        </TabControl>
        <Separator Grid.Row="1"
                   Margin="0" VerticalAlignment="Top"
                   Visibility="Collapsed" />
        <StackPanel Grid.Row="1"
                    Margin="-15,0,-15,-15" HorizontalAlignment="Center"
                    Orientation="Horizontal" Visibility="Collapsed">
            <RadioButton Width="35" Height="30"
                         Margin="5,0" Padding="5"
                         Style="{StaticResource MyRadioButtonStyle}">
                <ui:SymbolIcon Filled="True" Symbol="Cursor24" />
            </RadioButton>
            <Separator Margin="5" />
            <RadioButton Width="35" Height="30"
                         Margin="5,0" Padding="5"
                         Style="{StaticResource MyRadioButtonStyle}">
                <ui:SymbolIcon Filled="True" Symbol="Line20" />
            </RadioButton>
            <RadioButton Width="35" Height="30"
                         Margin="5,0" Padding="5"
                         Style="{StaticResource MyRadioButtonStyle}">
                <ui:SymbolIcon Symbol="RectangleLandscape12" />
            </RadioButton>
            <RadioButton Width="35" Height="30"
                         Margin="5,0" Padding="5"
                         Style="{StaticResource MyRadioButtonStyle}">
                <ui:SymbolIcon Symbol="Circle12" />
            </RadioButton>
            <RadioButton Width="35" Height="30"
                         Margin="5,0" Padding="5"
                         Style="{StaticResource MyRadioButtonStyle}">
                <ui:SymbolIcon Symbol="Text12" />
            </RadioButton>
        </StackPanel>
    </Grid>


</UserControl>
